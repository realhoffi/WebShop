<!DOCTYPE html>
<html ng-app="appAusgabenmanager">
<head lang="de">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Ausgabenmanager</title>
    <link href="../css/bootstrap.css" type="text/css" rel="stylesheet">
    <script src="../js/jquery-1.11.0.min.js" type="application/javascript"></script>
    <script src="../js/bootstrap.js" type="application/javascript"></script>
    <script src="../js/angular.js" type="application/javascript"></script>
    <script src="../js/ui-bootstrap-tpls-0.11.0.js" type="application/javascript"></script>
    <script src="../angular/app.js" type="application/javascript"></script>
    <script src="../angular/controller.js" type="application/javascript"></script>
    <script src="../angular/appHelper.js" type="application/javascript"></script>
    <script type="text/javascript">
        var user = function () {
            var self = this;
            self.Email = '';
            self.Nachname = '';
            self.Vorname = '';

        };
        var uid = '';

        $(document).ready(function () {
            $(".btnGo").click(function () {
                createUser();
            });
            $("#uploadFile").click(function () {
                upload();
            });
        });
        function upload() {
            var fileContent = $("#fileInput")[0];
            var file = fileContent.files[0];
            var name = file.name;
            var size = file.size;
            var type = file.type;


            var reader = new FileReader();

            reader.onload = function (event) {
                console.log(event.target);
            };
            console.log(file);
            reader.readAsDataURL(file);

            var xhr = new XMLHttpRequest();
            xhr.upload.onprogress = function (e) {
                var percent = ((100 * e.loaded) / e.total);
                // Render a pretty progress bar
            };
            xhr.onreadystatechange = function (e) {
                if (e.target.readyState == 4) {
                    // Handle file upload complete
                    alert('ready');
                } else if (e.target.readyState == 2) {
                    alert(e.target.status + " : " + e.target.statusText);
                }
            };
            //  xhr.open('POST', 'http://localhost:54091/File/SaveFile?fid=' + name, true);
            xhr.open('POST', 'http://info.fhoffma.net/services/File/SaveFile?fid=' + name, true);
            xhr.setRequestHeader('X-FileName', name); // Pass the filename along
            xhr.send(file);
        }
        function createUser() {
            var b = new user();
            b.Email = "flo@test.de";
            b.Nachname = "NNAME";

            b.Vorname = "FLORI";

            //var domain = "http://localhost:54091/";
            var domain = "http://info.fhoffma.net/services/";
            var aj = $.ajax({
                url: domain + "users/Register",
                type: "POST",
                data: JSON.stringify(b),
                contentType: 'application/json; charset=UTF-8',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    var c = data;
                    alert(JSON.stringify(c));
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert('fail');
                }
            });
        }
    </script>
</head>
<body>
<div class="container-fluid" ng-controller="ausgabenCtrl">
    <div class="row">
        <div class="col-md-12">
            <div class="page-header">
                <h1 class="text-center">Ausgabenmanager
                </h1>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-2">
            <div class="row">
            <div class="col-md-12">
                    <div class="panel panel-success">
                        <a href="#" class="list-group-item active">
                            <b> <span class="glyphicon glyphicon-user"></span> <span>Zusammenfassung</span></b>
                        </a>
                        <a href="#" class="list-group-item">
                            <span class="glyphicon "></span> Meine monatlichenAusgaben
                        </a>
                        <a href="#" class="list-group-item">
                            <span class="glyphicon "></span> Meine monatlichenAusgaben
                        </a>
                        <a href="#" class="list-group-item">
                            <span class="glyphicon "></span> Kostenkalkulation
                        </a>

                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-success">
                        <a href="#" class="list-group-item active">
                            <b> <span class="glyphicon glyphicon-user"></span> <span>Charts</span></b>
                        </a>
                        <a href="#" class="list-group-item">
                            <span class="glyphicon "></span> Google
                        </a>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-success">
                        <a href="#" class="list-group-item active">
                            <b> <span class="glyphicon glyphicon-star"></span> <span>Meine Favoriten</span></b>
                        </a>
                        <a href="#" class="list-group-item">
                            <span class="glyphicon "></span> Favorit 1
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-8" id="content">
            <div class="row">
                <div class="col-md-3"> Search: <input class="form-control" ng-model="query"></div>
                <div class="col-md-3"> Sort by:
                    <select class="form-control" ng-model="orderProp">
                        <option value="Beschreibung">Beschreibung</option>
                        <option value="Name">Name</option>
                    </select>
                </div>
                <div class="col-md-3"> Ausgabenzeitraum:
                    <select class="form-control" ng-model="Ausgabezeitraum"
                            ng-options="araum.Name for araum in Ausgabenzeitraeume">
                        <option value="">-- choose color --</option>
                    </select>

                </div>
            </div>
            <div class="row">
                <div class="panel-group" id="ausgabenAccordion"
                     ng-repeat="ausgabe in Ausgaben | filter:query | orderBy: orderProp">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a data-toggle="collapse" data-parent="#ausgabenAccordion" href="#acc{{ausgabe.ID}}"
                                   ng-click="toggleOpen(ausgabe, $event)">
                                    {{ausgabe.Name}}
                                </a>
                            </h4>
                        </div>
                        <div id="acc{{ausgabe.ID}}" class="panel-collapse collapse in">
                            <div class="panel-body">
                                Beschreibung: {{ausgabe.Beschreibung}}
                            </div>
                            Beschreibung22: {{ausgabe.AusgabezeitraumObject}}
                            Ausgabezeitraum: {{ausgabe.Ausgabezeitraum}}
                            <select class="form-control"
                                    ng-model="ausgabe.Ausgabezeitraum"
                                    ng-change="updateAusgabe(ausgabe.Ausgabezeitraum,ausgabe)"
                                    ng-options="choice.ID as choice.Name for choice in Ausgabenzeitraeume">
                                <option value="">-- Ausgabezeitraum ausw√§hlen --</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-2"></div>
</div>
<div class="row">
    <div class="panel-footer">
        <div class="col-md-12 alert alert-info">Keine Fragen erlaubt.</div>
    </div>
</div>
</div>
</body>
</html>